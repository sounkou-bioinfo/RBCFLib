
# RBCFLIB

**RBCFLib** provides a minimalist and GWAS-VCF centric R wrapper for
`htslib` and `bcftools`, enabling efficient manipulation of BCF/VCF
genomic data files directly within R. The package includes bundled
bcftools source code that is compiled during installation, then executes
bcftools commands as optimized subprocesses through a C interface that
handles piping, error capture, and process management. Some other
convenience functions for common tasks are also provided including a
custom index re-implementing the
[`Seqminer2`](https://github.com/zhanxw/seqminer) single chromosome
index format for fast random access to records.

Originally this project focused solely on lightweight bcftools wrapping
for GWAS-VCF workflows; over time it added score plugin helpers, a
custom VBI index + CGRanges integration, and finally the embedded
archived low-level `rbcf` bindings.

## Installation

### Requirements

- R
- Unix-like OS (Linux, macOS) or Windows WSL2
- htslib/bcftools system dependencies
- cmake (for building bundled SuiteSparse/CHOLMOD used by BCFToolsPGS if
  no system cholmod can be found)

``` r

# to install from r-universe

install.packages('RBCFLib', repos = c('https://sounkou-bioinfo.r-universe.dev'))

# install the developement version from github

devtools::install_github("sounkou-bioinfo/RBCFLib@develop")
```

## BCFTools Wrapper

RBCFLib provides direct access to the full bcftools CLI from R,
supporting all bcftools features and plugins with high performance and
robust error handling.

- **BCFTools Executable Wrapper:** Execute any `bcftools` command
  directly from R using `BCFToolsRun()`.
- **Piping and Pipeline Support:** Create processing workflows within R
  using `BCFToolsPipeline()`, which chains multiple bcftools commands in
  efficient pipelines with automatic process management and piping in
  optimized C code. The chain needs to be valid bcftools commands.
- **Version Information:** Retrieve `htslib` and `bcftools` library
  versions using `HTSLibVersion()` and `BCFToolsVersion()`.
- **Utility Functions:** Access the path to the bundled `bcftools`
  executable via `BCFToolsBinaryPath()` and the plugins installation
  directory with `BCFTOOLS_PLUGINS()`.

**Example:**

``` r
library(RBCFLib)
```

``` r
BCFToolsVersion() |> print()
#> [1] "1.22"
vcfFile <- system.file("exdata", "imputed.gt.vcf.gz", package = "RBCFLib")
results <- BCFToolsRun("+vcf2table", vcfFile)
print(results$stdout |> head(10))
#>  [1] "<<< chr21:5030082:G (n. 1)"     ""                              
#>  [3] "# Variant"                      "+--------+-------------------+"
#>  [5] "| KEY    | VALUE             |" "+--------+-------------------+"
#>  [7] "| CHROM  | chr21             |" "| POS    | 5030082           |"
#>  [9] "| ID     | chr21:5030082:G:A |" "| REF    | G                 |"
results <- BCFToolsPipeline(
    "view", c("-r", "chr21", "-Ob", vcfFile),
    "view", c("--no-version"),
    "query", c("-H","-f", "%CHROM\t%POS\t%REF\t%ALT\n")
    )
print(results$stdout |> head(10))
#>  [1] "#[1]CHROM\t[2]POS\t[3]REF\t[4]ALT" "chr21\t5030082\tG\tA"             
#>  [3] "chr21\t5030088\tC\tT"              "chr21\t5030105\tC\tA"             
#>  [5] "chr21\t5030240\tAC\tA"             "chr21\t5030253\tG\tT"             
#>  [7] "chr21\t5030278\tC\tG"              "chr21\t5030319\tC\tG,T"           
#>  [9] "chr21\t5030347\tG\tA"              "chr21\t5030356\tG\tC"
```

## BCFTools Score Plugins

RBCFLib provides R wrappers for the bcftools score plugin suite,
enabling GWAS-VCF conversion and polygenic score analysis:

- **`BCFToolsMunge`**: Convert summary statistics to GWAS-VCF format
- **`BCFToolsScore`**: Compute polygenic scores using genotype data and
  weights
- **`BCFToolsLiftover`**: Convert variants between genome assemblies
- **`BCFToolsMetal`**: Perform meta-analysis on GWAS-VCF files
- **`BCFToolsPGS`**: Compute polygenic score loadings (bundled
  SuiteSparse/CHOLMOD included)
- **`BCFToolsBLUP`**: Compute BLUP

For more details, see the [BCFTools Score
documentation](https://github.com/freeseek/score).

## VBI Indexes and CGRanges

RBCFLib includes a fast, custom index format (VBI) that uses a format
similar to [Seqminer2](https://github.com/zhanxw/seqminer), but with
additional [cgranges](https://github.com/lh3/cgranges/) support when
loading the index as C-level pointers. This enables rapid random access
and region queries on large VCF/BCF files. The cgranges library is
integrated to provide fast overlap retrieval of BCF/VCF ranges from
VBI-indexed files or for basic range-based tests.

### CGRanges Functions

Create and query genomic intervals using an efficient interval tree data
structure:

- `CGRangesCreate()`: Create a new CGRanges object
- `CGRangesAdd()`: Add genomic intervals
- `CGRangesIndex()`: Build the interval tree index
- `CGRangesOverlap()`: Find overlapping intervals
- `CGRangesOverlapVec()`: Vectorized overlap queries
- `CGRangesExtractByIndex()`: Extract intervals by index
- `CGRangesDestroy()`: Free memory

**Example:**

``` r
cr <- CGRangesCreate()
CGRangesAdd(cr, "chr1", 10, 20, 1)
#> NULL
CGRangesAdd(cr, "chr1", 15, 25, 2) 
#> NULL
CGRangesAdd(cr, "chr2", 5, 15, 3)
#> NULL
CGRangesIndex(cr)
#> NULL

# Find overlapping intervals
hits <- CGRangesOverlap(cr, "chr1", 18, 22)
print("Overlapping intervals:")
#> [1] "Overlapping intervals:"
print(hits)
#> [[1]]
#> [1] 1 2

# Extract intervals by index
extracted <- CGRangesExtractByIndex(cr, c(1, 2, 3))
print("Extracted intervals:")
#> [1] "Extracted intervals:"
print(extracted)
#> $chrom
#> [1] "chr1" "chr1" "chr2"
#> 
#> $start
#> [1] 10 15  5
#> 
#> $end
#> [1] 20 25 15
#> 
#> $label
#> [1] 2 3 4

CGRangesDestroy(cr)
#> NULL
```

### VBI Index Functions

The VBI (Variant Binary Index) system provides fast random access to
variants in VCF/BCF files:

- `VBIIndex()`: Create a VBI index for a VCF/BCF file
- `VBIIndexLoad()`: Load a VBI index file as an external pointer
- `VBIExtractRanges()`: Extract variant ranges from a VBI index
- `VBIPrintIndex()`: Print lines from a VBI index for debugging
- `VBIQueryRange()`: Query VBI index by genomic region (linear scan)
- `VBIQueryByIndices()`: Query VBI index by variant index range
- `VBIQueryRegion()`: Query VBI index by region with
  INFO/FORMAT/genotype options
- `VBIQueryRegionCGRanges()`: Query VBI index by region using CGRanges
  (fast interval tree)
- `VBIIndexMemoryUsage()`: Get memory usage statistics

**Example:**

``` r
vcfFile <- system.file("exdata", "imputed.gt.vcf.gz", package = "RBCFLib")
vbiFile <- tempfile(fileext = ".vbi")

# Create VBI index
VBIIndex(vcfFile, vbiFile)
#> Wrote 15 index records into /tmp/RtmpK55x6P/filed3eff50bf6090.vbi
#> Indexing  finished: 3202 samples, 15 markers, 1 chromosomes
#> NULL

# Load VCF with VBI integration
vcf_ctx <- VCFLoad(vcfFile, vbiFile)

# Get basic info
print(paste("Samples:", VBINSamples(vcf_ctx)))
#> [1] "Samples: 3202"

# Query by variant index range (1-based, inclusive)
hits_by_index <- VBIQueryByIndices(vcf_ctx, 1, 3)
print("First 3 variants by index:")
#> [1] "First 3 variants by index:"
print(hits_by_index)
#>   chrom     pos                id ref alt qual filter n_allele index
#> 1 chr21 5030082 chr21:5030082:G:A   G   A   NA   PASS        2     1
#> 2 chr21 5030088 chr21:5030088:C:T   C   T   NA   PASS        2     2
#> 3 chr21 5030105 chr21:5030105:C:A   C   A   NA   PASS        2     3

# Query by genomic region with basic fields
hits_region <- VBIQueryRegion(vcf_ctx, "chr21:5030082-5030356")
print("Region query results (basic fields):")
#> [1] "Region query results (basic fields):"
print(hits_region)
#>   chrom     pos                  id ref alt qual filter n_allele index
#> 1 chr21 5030082   chr21:5030082:G:A   G   A   NA   PASS        2     1
#> 2 chr21 5030088   chr21:5030088:C:T   C   T   NA   PASS        2     2
#> 3 chr21 5030105   chr21:5030105:C:A   C   A   NA   PASS        2     3
#> 4 chr21 5030240  chr21:5030240:AC:A  AC   A   NA   PASS        2     4
#> 5 chr21 5030253   chr21:5030253:G:T   G   T   NA   PASS        2     5
#> 6 chr21 5030278   chr21:5030278:C:G   C   G   NA   PASS        2     6
#> 7 chr21 5030319 chr21:5030319:C:G,T   C G,T   NA   PASS        3     7
#> 8 chr21 5030347   chr21:5030347:G:A   G   A   NA   PASS        2     8
#> 9 chr21 5030356   chr21:5030356:G:C   G   C   NA   PASS        2     9

# Query by genomic region using CGRanges (fast interval tree)
hits_cgranges <- VBIQueryRegionCGRanges(vcf_ctx, "chr21:5030082-5030356")
print("CGRanges query results (should be identical to region query):")
#> [1] "CGRanges query results (should be identical to region query):"
print(hits_cgranges)
#>   chrom     pos                  id ref alt qual filter n_allele index
#> 1 chr21 5030082   chr21:5030082:G:A   G   A   NA   PASS        2     1
#> 2 chr21 5030088   chr21:5030088:C:T   C   T   NA   PASS        2     2
#> 3 chr21 5030105   chr21:5030105:C:A   C   A   NA   PASS        2     3
#> 4 chr21 5030240  chr21:5030240:AC:A  AC   A   NA   PASS        2     4
#> 5 chr21 5030253   chr21:5030253:G:T   G   T   NA   PASS        2     5
#> 6 chr21 5030278   chr21:5030278:C:G   C   G   NA   PASS        2     6
#> 7 chr21 5030319 chr21:5030319:C:G,T   C G,T   NA   PASS        3     7
#> 8 chr21 5030347   chr21:5030347:G:A   G   A   NA   PASS        2     8
#> 9 chr21 5030356   chr21:5030356:G:C   G   C   NA   PASS        2     9

# Verify equality between regular and CGRanges queries
print(paste("Results are identical:", identical(hits_region, hits_cgranges)))
#> [1] "Results are identical: TRUE"

# Query by genomic region with INFO fields
hits_with_info <- VBIQueryRegion(vcf_ctx, "chr21:5030082-5030356", include_info = TRUE)
print("Region query results (with INFO):")
#> [1] "Region query results (with INFO):"
print(hits_with_info[1:3, ])  # Show first 3 rows only
#>   chrom     pos                id ref alt qual filter n_allele index INFO
#> 1 chr21 5030082 chr21:5030082:G:A   G   A   NA   PASS        2     1 <NA>
#> 2 chr21 5030088 chr21:5030088:C:T   C   T   NA   PASS        2     2 <NA>
#> 3 chr21 5030105 chr21:5030105:C:A   C   A   NA   PASS        2     3 <NA>

# Query with genotype data
hits_with_gt <- VBIQueryRegion(vcf_ctx, "chr21:5030082-5030356", include_genotypes = TRUE)
print("Region query with genotypes:")
#> [1] "Region query with genotypes:"
print(hits_with_gt[1:2, c("chrom", "pos", "ref", "alt", "GT")])
#>   chrom     pos ref alt
#> 1 chr21 5030082   G   A
#> 2 chr21 5030088   C   T
#>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        GT
#> 1 0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;1/1;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0
#> 2 1/1;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;1/1;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;1/1;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;1/1;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;1/1;0/0;0/0;0/0;0/0;0/0;1/1;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;1/1;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/1;0/0;0/0;0/0;0/0;0/0;1/1;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;1/1;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;1/1;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;1/1;0/0;0/0;0/0;0/0;1/1;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;1/1;1/1;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;1/1;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;1/1;1/1;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;1/1;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/1;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/1;0/0;0/0;0/0;1/0;0/0;0/0;0/0;0/0;0/0;1/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;1/0;0/0;0/0;0/0;0/0;0/0;0/0;1/1;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;1/1;0/0;1/1;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;1/1;1/1;0/0;0/0;1/1;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;1/1;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;1/1;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;1/1;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;1/1;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/1;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;1/1;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/1;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;1/1;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;1/1;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/1;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/1;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;1/1;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;1/1;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;1/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;1/1;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/1;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/1;0/0;0/0;0/0;0/0;1/1;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;1/1;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;1/1;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;1/1;0/0;0/0;0/0;1/1;0/0;0/0;0/0;0/0;1/1;0/0;1/1;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/1;1/1;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;1/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;1/1;0/0;0/0;0/0;1/1;0/0;0/0;0/0;1/1;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;1/1;0/0;0/0;0/0;1/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;1/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;1/1;0/0;1/1;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;1/1;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;1/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;1/1;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;1/1;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;1/1;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;1/1;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;1/1;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;1/1;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/1;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;1/1;0/0;0/0;0/0;0/0;0/0;0/0;0/0;1/1;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;1/1;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;1/1;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;1/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;1/1;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0;0/0

# Query with all fields (INFO, FORMAT, and genotypes)
hits_all <- VBIQueryRegion(vcf_ctx, "chr21:5030082-5030356", 
                          include_info = TRUE, 
                          include_format = TRUE, 
                          include_genotypes = TRUE)
print("All available columns:")
#> [1] "All available columns:"
print(colnames(hits_all))
#>  [1] "chrom"      "pos"        "id"         "ref"        "alt"       
#>  [6] "qual"       "filter"     "n_allele"   "index"      "INFO"      
#> [11] "FORMAT_IDS" "GT"

# Load index as external pointer for direct access
vbi_ptr <- VBIIndexLoad(vbiFile)

# Extract variant ranges
ranges <- VBIExtractRanges(vbi_ptr, 5)
print("First 5 variant ranges:")
#> [1] "First 5 variant ranges:"
print(ranges)
#>   chrom     pos index
#> 1 chr21 5030082     1
#> 2 chr21 5030088     2
#> 3 chr21 5030105     3
#> 4 chr21 5030240     4
#> 5 chr21 5030253     5

# Check memory usage
mem_usage <- VBIIndexMemoryUsage(vbi_ptr)
print(paste("VBI memory usage:", round(sum(unlist(mem_usage)) / 1e6, 3), "MB"))
#> [1] "VBI memory usage: 0.001 MB"

# Clean up
unlink(vbiFile)
```

### Performance Optimization

The VBI system includes optimized query methods for different use cases:

- **`VBIQueryRegion()`**: Standard region queries using linear scan
  through the index
- **`VBIQueryRegionCGRanges()`**: Optimized region queries using
  interval tree (cgranges) for faster lookups
- **`VBIQueryByIndices()`**: Direct access by variant index for
  sequential access patterns

The cgranges-optimized queries can provide significant performance
improvements for complex interval queries, especially with large
datasets. The optimization eliminates redundant file I/O operations and
leverages efficient interval tree data structures.

## Embedded original `rbcf` low-level API

This repository now embeds (with minor updates for htslib 1.21 and
current R API) the archived low-level VCF/BCF binding code authored by
Pierre Lindenbaum (original project: lindenb/rbcf). These functions
expose opaque external pointer contexts and direct accessor helpers.
They coexist with the higher-level bcftools process wrappers, letting
you mix streaming (low-level) and pipeline (bcftools) workflows. See
tinytests and man pages for concise examples. Attribution: Pierre
Lindenbaum PhD (@yokofakun).

- Open / iterate / write: `BCFOpen()`, `BCFNext()`, `BCFNewWriter()`,
  `BCFWriteVariant()`, `BCFClose()`
- Header & samples: `BCFNSamples()`, `BCFSamples()`, `BCFSampleAt()`,
  `BCFSample2Index()`, `BCFChromosomes()`, `BCFDictionary()`
- Variant access: `VariantPos()`, `VariantAlleles()`,
  `VariantReference()`, `VariantAltAlleles()`, `VariantHasQual()`,
  `VariantQual()`, `VariantFilters()` etc.
- INFO / FORMAT: `VariantHasAttribute()`, `VariantStringAttribute()`,
  `VariantIntAttribute()`, `VariantFloatAttribute()`,
  `VariantFlagAttribute()`
- Genotypes: `VariantGenotype()`, `VariantGenotypesAlleleIdx0()`,
  `GenotypePloidy()`, `GenotypeHomRef()`, `GenotypeHet()` 
- Annotations: `VariantVep()`, `VariantSnpEff()`

### Low-level examples (adapted from original `rbcf`)

All examples use packaged example data via
`system.file("exdata", ..., package = "RBCFLib")`.

#### Versions

``` r
library(RBCFLib)
HTSLibVersion()
#> [1] "1.22"
BCFToolsVersion()
#> [1] "1.22"
```

#### Open and close a VCF (no index required)

``` r
vcf <- system.file("exdata","rotavirus_rf.01.vcf", package="RBCFLib")
fp <- BCFOpen(vcf, requireIndex = FALSE)
stopifnot(!is.null(fp))
BCFClose(fp)
#> [1] TRUE
```

#### List INFO / FORMAT / FILTER header fields

``` r
fp <- BCFOpen(vcf, requireIndex = FALSE)
head(BCFInfos(fp))      # show first rows
#>          ID Number    Type
#> INDEL INDEL      0    Flag
#> IDV     IDV      1 Integer
#> IMF     IMF      1   Float
#> DP       DP      1 Integer
#> VDB     VDB      1   Float
#> RPB     RPB      1   Float
#>                                                                                          Description
#> INDEL                                                      "Indicates that the variant is an INDEL."
#> IDV                                                    "Maximum number of reads supporting an indel"
#> IMF                                                  "Maximum fraction of reads supporting an indel"
#> DP                                                                                  "Raw read depth"
#> VDB   "Variant Distance Bias for filtering splice-site artefacts in RNA-seq data (bigger is better)"
#> RPB                                   "Mann-Whitney U test of Read Position Bias (bigger is better)"
head(BCFFormats(fp))
#>    ID Number    Type                                 Description
#> PL PL      G Integer "List of Phred-scaled genotype likelihoods"
#> GT GT      1  String                                  "Genotype"
BCFFilters(fp)
#>        ID          Description
#> PASS PASS "All filters passed"
BCFClose(fp)
#> [1] TRUE
```

#### Samples and dictionary

``` r
fp <- BCFOpen(vcf, requireIndex = FALSE)
BCFNSamples(fp)
#> [1] 5
BCFSamples(fp)
#> [1] "S1" "S2" "S3" "S4" "S5"
BCFSampleAt(fp, 1)
#> [1] "S1"
BCFSample2Index(fp, c("S1","S2","missing"))
#>      S1      S2 missing 
#>       1       2       0
BCFDictionary(fp)
#>      chrom size
#> RF01  RF01 3302
#> RF02  RF02 2687
#> RF03  RF03 2592
#> RF04  RF04 2362
#> RF05  RF05 1579
#> RF06  RF06 1356
#> RF07  RF07 1074
#> RF08  RF08 1059
#> RF09  RF09 1062
#> RF10  RF10  751
#> RF11  RF11  666
BCFClose(fp)
#> [1] TRUE
```

#### Indexed chromosomes / contigs

``` r
vcf_gz <- system.file("exdata","rotavirus_rf.02.vcf.gz", package="RBCFLib")
fp <- BCFOpen(vcf_gz)
BCFChromosomes(fp)
#>  [1] "RF01" "RF02" "RF03" "RF04" "RF05" "RF06" "RF07" "RF08" "RF09" "RF10"
#> [11] "RF11"
BCFClose(fp)
#> [1] TRUE
```

#### Scan all variants (count)

``` r
count_variants <- function(f, requireIndex = FALSE) {
  fp <- BCFOpen(f, requireIndex=requireIndex)
  if(is.null(fp)) return(NA_integer_)
  n <- 0L
  while(!is.null(vc <- BCFNext(fp))) n <- n + 1L
  BCFClose(fp); n
}
count_variants(vcf)
#> [1] 45
```

#### Predicate scan (e.g.count PASS SNPs)

``` r
fp <- BCFOpen(system.file("exdata","gnomad.exomes.r2.0.1.sites.bcf", package="RBCFLib"))
pass_snps <- 0L
while(!is.null(vc <- BCFNext(fp))) {
  if(length(VariantFilters(vc))==0L && VariantAlleles(vc)[1] %in% c("A","C","G","T") &&
     all(nchar(VariantAlleles(vc))==1L)) pass_snps <- pass_snps + 1L
}
BCFClose(fp)
#> [1] TRUE
pass_snps
#> [1] 45
```

#### Query regions

``` r
fp <- BCFOpen(vcf_gz)
count_RF03 <- NA_integer_
if(BCFQuery(fp, "RF03")) {
  k <- 0L
  while(!is.null(vc <- BCFNext(fp))) k <- k + 1L
  count_RF03 <- k
}
# window query (sets iterator)
BCFQuery(fp, "RF03:2000-3000")
#> [1] TRUE
BCFClose(fp)
#> [1] TRUE
count_RF03
#> [1] 8
```

#### Find a specific variant & access INFO attributes

``` r
find_variant <- function(f, region) {
  fp <- BCFOpen(f)
  on.exit(BCFClose(fp))
  if(!BCFQuery(fp, region)) return(NULL)
  BCFNext(fp)
}
site_bcf <- system.file("exdata","gnomad.exomes.r2.0.1.sites.bcf", package="RBCFLib")
vc_site <- find_variant(site_bcf, "1:905608-905608")
if(!is.null(vc_site) && VariantHasAttribute(vc_site, "AF_POPMAX")) {
  VariantFloatAttribute(vc_site, "AF_POPMAX")
}
#> [1] 1.87956e-05 9.39779e-06
```

#### VEP / SnpEff annotations

``` r
# VEP (CSQ)
vc_vep <- find_variant(site_bcf, "1:905608-905608")
if(!is.null(vc_vep) && VariantHasAttribute(vc_vep, "CSQ")) {
  head(VariantVep(vc_vep))
}
#>   Allele             Consequence   IMPACT   SYMBOL            Gene Feature_type
#> 1      T downstream_gene_variant MODIFIER   KLHL17 ENSG00000187961   Transcript
#> 2      A downstream_gene_variant MODIFIER   KLHL17 ENSG00000187961   Transcript
#> 3      T downstream_gene_variant MODIFIER C1orf170 ENSG00000187642   Transcript
#> 4      A downstream_gene_variant MODIFIER C1orf170 ENSG00000187642   Transcript
#> 5      T          intron_variant MODIFIER  PLEKHN1 ENSG00000187583   Transcript
#> 6      A          intron_variant MODIFIER  PLEKHN1 ENSG00000187583   Transcript
#>           Feature        BIOTYPE EXON INTRON                         HGVSc
#> 1 ENST00000338591 protein_coding                                          
#> 2 ENST00000338591 protein_coding                                          
#> 3 ENST00000341290 protein_coding                                          
#> 4 ENST00000341290 protein_coding                                          
#> 5 ENST00000379407 protein_coding        2/14 ENST00000379407.3:c.184-49G>T
#> 6 ENST00000379407 protein_coding        2/14 ENST00000379407.3:c.184-49G>A
#>   HGVSp cDNA_position CDS_position Protein_position Amino_acids Codons
#> 1                                                                     
#> 2                                                                     
#> 3                                                                     
#> 4                                                                     
#> 5                                                                     
#> 6                                                                     
#>   Existing_variation ALLELE_NUM DISTANCE STRAND FLAGS VARIANT_CLASS MINIMISED
#> 1        rs770396126          1     4513      1                 SNV          
#> 2        rs770396126          2     4513      1                 SNV          
#> 3        rs770396126          1     4976     -1                 SNV          
#> 4        rs770396126          2     4976     -1                 SNV          
#> 5        rs770396126          1               1                 SNV          
#> 6        rs770396126          2               1                 SNV          
#>   SYMBOL_SOURCE HGNC_ID CANONICAL TSL APPRIS        CCDS            ENSP
#> 1          HGNC   24023       YES            CCDS30550.1 ENSP00000343930
#> 2          HGNC   24023       YES            CCDS30550.1 ENSP00000343930
#> 3          HGNC   28208                                  ENSP00000343864
#> 4          HGNC   28208                                  ENSP00000343864
#> 5          HGNC   25284                      CCDS53256.1 ENSP00000368717
#> 6          HGNC   25284                      CCDS53256.1 ENSP00000368717
#>   SWISSPROT        TREMBL       UNIPARC GENE_PHENO SIFT PolyPhen DOMAINS
#> 1    Q6TDP4 Q0VGE6&B3KXL7 UPI00001DFBF0                                 
#> 2    Q6TDP4 Q0VGE6&B3KXL7 UPI00001DFBF0                                 
#> 3                         UPI000022DAF4                                 
#> 4                         UPI000022DAF4                                 
#> 5    Q494U1        J3KSM5 UPI00005764FF                                 
#> 6    Q494U1        J3KSM5 UPI00005764FF                                 
#>   HGVS_OFFSET GMAF AFR_MAF AMR_MAF EAS_MAF EUR_MAF SAS_MAF AA_MAF EA_MAF
#> 1                      T:0                                              
#> 2                      T:0                                              
#> 3                      T:0                                              
#> 4                      T:0                                              
#> 5                      T:0                                              
#> 6                      T:0                                              
#>   ExAC_MAF ExAC_Adj_MAF ExAC_AFR_MAF ExAC_AMR_MAF ExAC_EAS_MAF ExAC_FIN_MAF
#> 1                   T:0  T:8.253e-06          T:0  T:8.764e-06          T:0
#> 2                   T:0  T:8.253e-06          T:0  T:8.764e-06          T:0
#> 3                   T:0  T:8.253e-06          T:0  T:8.764e-06          T:0
#> 4                   T:0  T:8.253e-06          T:0  T:8.764e-06          T:0
#> 5                   T:0  T:8.253e-06          T:0  T:8.764e-06          T:0
#> 6                   T:0  T:8.253e-06          T:0  T:8.764e-06          T:0
#>   ExAC_NFE_MAF ExAC_OTH_MAF ExAC_SAS_MAF CLIN_SIG SOMATIC PHENO PUBMED
#> 1          T:0  T:1.604e-05          T:0                              
#> 2          T:0  T:1.604e-05          T:0                              
#> 3          T:0  T:1.604e-05          T:0                              
#> 4          T:0  T:1.604e-05          T:0                              
#> 5          T:0  T:1.604e-05          T:0                              
#> 6          T:0  T:1.604e-05          T:0                              
#>   MOTIF_NAME MOTIF_POS HIGH_INF_POS MOTIF_SCORE_CHANGE LoF LoF_filter LoF_flags
#> 1                                                                              
#> 2                                                                              
#> 3                                                                              
#> 4                                                                              
#> 5                                                                              
#> 6                                                                              
#>   LoF_info"
#> 1          
#> 2          
#> 3          
#> 4          
#> 5          
#> 6
# SnpEff (ANN)
ann_vcf <- system.file("exdata","rotavirus_rf.ann.vcf.gz", package="RBCFLib")
vc_ann <- find_variant(ann_vcf, "RF03:2150-2150")
if(!is.null(vc_ann) && VariantHasAttribute(vc_ann, "ANN")) {
  head(VariantSnpEff(vc_ann))
}
#>   Allele       Annotation Annotation_Impact    Gene_Name      Gene_ID
#> 1      A missense_variant          MODERATE Gene_50_2557 Gene_50_2557
#>   Feature_Type Feature_ID Transcript_BioType Rank    HGVS.c      HGVS.p
#> 1   transcript AAM80568.1     protein_coding  1/1 c.2100T>A p.Phe700Leu
#>   cDNA.pos / cDNA.length CDS.pos / CDS.length AA.pos / AA.length Distance
#> 1              2100/2508            2100/2508            700/835         
#>   ERRORS / WARNINGS / INFO'"
#> 1
```

#### Genotype access (single sample)

``` r
geno_bcf <- system.file("exdata","1000G.ALL.2of4intersection.20100804.genotypes.bcf", package="RBCFLib")
vc_gt <- find_variant(geno_bcf, "1:10583-10583")
if(!is.null(vc_gt)) {
  ns <- VariantNSamples(vc_gt)
  gt10 <- VariantGenotype(vc_gt, 10)
  list(sample=GenotypeSample(gt10), ploidy=GenotypePloidy(gt10), het=GenotypeHet(gt10))
}
#> $sample
#> [1] "HG00120"
#> 
#> $ploidy
#> [1] 2
#> 
#> $het
#> [1] TRUE
```

#### Vectorized genotype attributes

``` r
if(!is.null(vc_gt)) {
  dp <- VariantGenotypesIntAttribute(vc_gt, "DP")
  gt_idx <- VariantGenotypesAlleleIdx0(vc_gt)
  gt_ref_counts <- VariantGenotypesAlleleCounts(vc_gt, 0)
  gt_str <- VariantGenotypesAlleleStrings(vc_gt)
  list(DP=head(dp), GT_IDX=head(gt_idx), REF_COUNTS=head(gt_ref_counts), GT_STR=head(gt_str))
}
#> $DP
#> [1] NA NA NA NA NA NA
#> 
#> $GT_IDX
#> [1] 0 0 0 0 0 0
#> 
#> $REF_COUNTS
#> [1] 2 2 2 2 2 2
#> 
#> $GT_STR
#> [1] "0|0" "0|0" "0|0" "0|0" "0|0" "0|0"
```

#### Write filtered variants to stdout

``` r
fp_in <- BCFOpen(vcf, requireIndex=FALSE)
out <- BCFNewWriter(fp_in, "-")
while(!is.null(v <- BCFNext(fp_in))) {
  if(VariantPos(v) %% 10 == 0) BCFWriteVariant(out, v)
}
BCFClose(fp_in); BCFClose(out)
#> [1] TRUE
#> [1] TRUE
```

## Related Projects

- [gwasvcf](https://github.com/MRCIEU/gwasvcf): R package for
  manipulating GWAS summary statistics in VCF format.
- [MungeSumstats](https://github.com/Al-Murphy/MungeSumstats): R package
  for standardizing GWAS summary statistics.
- [Seqminer2](https://github.com/zhanxw/seqminer): Fast random access to
  BCF/VCF files using a custom index format.
- [vcfppR](https://github.com/Zilong-Li/vcfppR): Ultra-fast BCF/VCF I/O
  in R using Rcpp.

## Future Directions

- RgwasVCF: Advanced GWAS-VCF manipulation and analysis with convenient
  interfaces, depending on RBCFLib.
- RArrowBCF: High-performance BCF/VCF I/O using Apache Arrow for
  in-memory data representation.

## TODO

- [ ] Use the bundled hmmap plugin ?
