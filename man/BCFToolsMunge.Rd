% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/BCFToolsMunge.R
\name{BCFToolsMunge}
\alias{BCFToolsMunge}
\title{Run BCFTools Munge Command}
\usage{
BCFToolsMunge(
  input_file = NULL,
  fasta_ref = NULL,
  output = NULL,
  columns = NULL,
  columns_file = NULL,
  fai = NULL,
  set_cache_size = NULL,
  iffy_tag = NULL,
  mismatch_tag = NULL,
  sample_name = NULL,
  ns = NULL,
  nc = NULL,
  args = character(),
  catchStdout = TRUE,
  catchStderr = TRUE,
  saveStdout = NULL,
  isUsage = FALSE
)
}
\arguments{
\item{input_file}{Path to input GWAS summary statistics TSV file}

\item{fasta_ref}{Path to reference sequence in FASTA format}

\item{output}{File path for output VCF (if NULL, will use a temporary file)}

\item{columns}{Column header preset (one of: PLINK, PLINK2, REGENIE, SAIGE, BOLT, METAL, PGS, SSF)}

\item{columns_file}{Path to tab-delimited file with column headers mapping}

\item{fai}{Path to reference sequence .fai index}

\item{set_cache_size}{Cache size in bytes for FASTA parsing}

\item{iffy_tag}{FILTER annotation tag for when reference allele is uncertain (default: "IFFY")}

\item{mismatch_tag}{FILTER annotation tag for when reference doesn't match any allele (default: "REF_MISMATCH")}

\item{sample_name}{Sample name for the phenotype (default: "SAMPLE")}

\item{ns}{Number of samples in the study}

\item{nc}{Number of cases in the study (for case-control studies)}

\item{args}{Additional command-line arguments as character vector}

\item{catchStdout}{Logical; whether to capture standard output (default: TRUE)}

\item{catchStderr}{Logical; whether to capture standard error (default: TRUE)}

\item{saveStdout}{Character; file path where to save standard output, or NULL (default: NULL)}

\item{isUsage}{Logical; if TRUE, will not redirect output (default: FALSE)}
}
\value{
A named list with elements:
\describe{
\item{status}{Integer exit status of the bcftools munge command (0 for success, non-zero for errors)}
\item{stdout}{Character vector of captured standard output lines, or NULL if not captured}
\item{stderr}{Character vector of captured standard error lines, or NULL if not captured}
\item{command}{Character vector representing the full bcftools munge command invoked}
}
}
\description{
Executes bcftools munge command from within R using the embedded bcftools library.
This function is specifically designed for the munge command which converts GWAS
summary statistics to VCF format.
}
\examples{
\dontrun{
# Convert GWAS summary statistics to VCF with basic parameters
inFile <- system.file("exdata", "test_plink.tsv", package = "RBCFLib")
refFile <- system.file("exdata", "Test.fa", package = "RBCFLib")
outFile <- tempfile(fileext = ".vcf")

# Using the main parameters
result <- BCFToolsMunge(input_file = inFile, fasta_ref = refFile, output = outFile)

# With column preset
result <- BCFToolsMunge(
    input_file = inFile,
    fasta_ref = refFile,
    output = outFile,
    columns = "PLINK"
)

# With custom column mappings
colFile <- system.file("exdata", "colheaders.tsv", package = "RBCFLib")
result <- BCFToolsMunge(
    input_file = inFile,
    fasta_ref = refFile,
    output = outFile,
    columns_file = colFile
)
}

}
