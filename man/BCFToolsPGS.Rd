% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/BCFToolsPGS.R
\name{BCFToolsPGS}
\alias{BCFToolsPGS}
\title{Compute Polygenic Score Loadings Using BCFTools PGS}
\usage{
BCFToolsPGS(
  InputFileName,
  LDMatrix,
  Regions = NULL,
  RegionsFile = NULL,
  Targets = NULL,
  TargetsFile = NULL,
  Prior = NULL,
  LDScoreTag = NULL,
  QScoreThreshold = NULL,
  MaxFileSize = NULL,
  MaxChunkSize = NULL,
  AverageEffects = FALSE,
  AverageLDScore = NULL,
  ExpectedRatio = NULL,
  MAFThreshold = NULL,
  NoNormalize = FALSE,
  SampleNames = NULL,
  SamplesFile = NULL,
  IncludeFilter = NULL,
  ExcludeFilter = NULL,
  OutputFile = NULL,
  OutputType = NULL,
  NumThreads = NULL,
  WriteIndex = FALSE,
  CatchStdout = TRUE,
  CatchStderr = TRUE,
  SaveStdout = NULL
)
}
\arguments{
\item{InputFileName}{Character; Path to GWAS-VCF file with summary statistics.}

\item{LDMatrix}{Character; Path to LDGM file with sparse LD matrix.}

\item{Regions}{Character; Restrict to comma-separated list of regions.}

\item{RegionsFile}{Character; Restrict to regions listed in file.}

\item{Targets}{Character; Similar to Regions but streams rather than index-jumps.}

\item{TargetsFile}{Character; Similar to RegionsFile but streams rather than index-jumps.}

\item{Prior}{Character; Prior specification for effect size variance.}

\item{LDScoreTag}{Character; INFO tag containing LD score values.}

\item{QScoreThreshold}{Numeric; Minimum quality score threshold for variants.}

\item{MaxFileSize}{Integer; Maximum file size in MB for memory mapping.}

\item{MaxChunkSize}{Integer; Maximum chunk size in MB for memory mapping.}

\item{AverageEffects}{Logical; Average effects across proxies for redundant sites.}

\item{AverageLDScore}{Numeric; Average genome-wide LD score for variants.}

\item{ExpectedRatio}{Numeric; Expected ratio of associations to null.}

\item{MAFThreshold}{Numeric; Remove variants with MAF below this threshold.}

\item{NoNormalize}{Logical; Do not normalize by allele frequency.}

\item{SampleNames}{Character; Comma-separated list of sample names to process.}

\item{SamplesFile}{Character; File with list of samples to include.}

\item{IncludeFilter}{Character; Include sites for which the expression is true.}

\item{ExcludeFilter}{Character; Exclude sites for which the expression is true.}

\item{OutputFile}{Character; Path to output file.}

\item{OutputType}{Character; b: compressed BCF, u: uncompressed BCF, z: compressed VCF, v: uncompressed VCF.}

\item{NumThreads}{Integer; Number of extra output compression threads.}

\item{WriteIndex}{Logical or Character; Automatically index the output file (optionally specify index format).}

\item{CatchStdout}{Logical; Capture standard output.}

\item{CatchStderr}{Logical; Capture standard error.}

\item{SaveStdout}{Character; Path to save standard output to.}
}
\value{
A named list with elements:
\describe{
\item{status}{Integer exit status of the command (0 for success, non-zero for errors)}
\item{stdout}{Character vector of captured standard output lines, or NULL if not captured}
\item{stderr}{Character vector of captured standard error lines, or NULL if not captured}
\item{command}{Character vector representing the full command invoked}
}
}
\description{
Runs the BCFTools pgs plugin to compute polygenic score loadings.
This function converts GWAS summary statistics into polygenic score loadings
by accounting for linkage disequilibrium (LD) between variants.
Requires CHOLMOD library for sparse matrix operations.
}
\note{
This function requires the CHOLMOD library for sparse matrix operations.
If the package was not compiled with CHOLMOD support, an error will be thrown.
}
