HTSLIB_DIR=$(CURDIR)/bcftools-1.22/htslib-1.22
BCFTOOLS_VERSION_DIR=$(CURDIR)/bcftools-1.22

# Platform-specific linker flags
UNAME := $(shell uname)
ifeq ($(UNAME), Linux)
  PKG_LIBS_EXTRA=-Wl,--exclude-libs,ALL
else
  PKG_LIBS_EXTRA=
endif

# Check for CHOLMOD (still needed for any cholmod-dependent code)
HAVE_CHOLMOD=1

# Base flags - minimal for version functions and HTSlib only
PKG_CPPFLAGS=-I$(HTSLIB_DIR) -I$(HTSLIB_DIR) -I$(BCFTOOLS_VERSION_DIR)  -DNDEBUG -DUSE_GSL -I/usr/include 
PKG_LIBS=$(HTSLIB_DIR)/libhts.a -lz -lm -lbz2 -llzma -lcurl -ldeflate  -L/usr/lib/x86_64-linux-gnu -lgsl -lgslcblas -lm $(PKG_LIBS_EXTRA)

# Add CHOLMOD support if available (for any remaining cholmod dependencies)
ifeq ($(HAVE_CHOLMOD),yes)
  PKG_CPPFLAGS += -DHAVE_CHOLMOD -I/home/sounkoutoure/Projects/RBCFLib/src/SuiteSparse/install/include -I/home/sounkoutoure/Projects/RBCFLib/src/SuiteSparse/install/include/suitesparse
  PKG_LIBS += -L/home/sounkoutoure/Projects/RBCFLib/src/SuiteSparse/install/lib -lcholmod -lccolamd -lcolamd -lcamd -lamd -lsuitesparseconfig
endif

.PHONY: all

all: $(SHLIB)
