HTSLIB_DIR=$(CURDIR)/bcftools-1.22/htslib-1.22
BCFTOOLS_VERSION_DIR=$(CURDIR)/bcftools-1.22

# Platform-specific linker flags
UNAME := $(shell uname)
ifeq ($(UNAME), Linux)
  PKG_LIBS_EXTRA=-Wl,--exclude-libs,ALL
else
  PKG_LIBS_EXTRA=
endif

# Check for CHOLMOD (still needed for any cholmod-dependent code)
HAVE_CHOLMOD=@HAVE_CHOLMOD@

# Base flags - minimal for version functions and HTSlib only
PKG_CPPFLAGS=-I$(HTSLIB_DIR) -I$(HTSLIB_DIR) -I$(BCFTOOLS_VERSION_DIR) @EXTRA_CPPFLAGS@
PKG_LIBS=$(HTSLIB_DIR)/libhts.a @EXTRA_LIBS@ $(PKG_LIBS_EXTRA)

# Add CHOLMOD support if available (for any remaining cholmod dependencies)
ifeq ($(HAVE_CHOLMOD),yes)
  PKG_CPPFLAGS += -DHAVE_CHOLMOD @CHOLMOD_CPPFLAGS@
  PKG_LIBS += @CHOLMOD_LIBS@
endif

.PHONY: all

all: $(SHLIB)
